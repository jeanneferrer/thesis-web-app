(()=>{const e=document.getElementById("video"),t=document.getElementById("startButton"),n=document.getElementById("stopButton"),o=document.getElementById("captureButton"),s=document.getElementById("canvas"),r=document.getElementById("compressedImage"),i=document.getElementById("metrics"),a=(document.getElementById("camera-container"),document.getElementById("capture-container")),c=document.getElementById("results-container"),d=document.getElementById("error-container"),m=document.getElementById("error-message");let l;function p(e){m.textContent=e,d.style.display="block"}t.addEventListener("click",(()=>{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:!0}).then((s=>{l=s,e.srcObject=l,e.onloadedmetadata=()=>{e.play()},n.disabled=!1,o.disabled=!1,t.disabled=!0,d.style.display="none"})).catch((e=>{console.error("Error accessing the camera:",e),p("Unable to access the camera. Please check permissions.")})):p("Camera access is not supported in this browser.")})),n.addEventListener("click",(()=>{l&&(l.getTracks().forEach((e=>e.stop())),e.srcObject=null,n.disabled=!0,o.disabled=!0,t.disabled=!1)})),o.addEventListener("click",(()=>{s.getContext("2d").drawImage(e,0,0,s.width,s.height),s.toBlob((e=>{if(!e)return void p("Failed to capture image.");const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{var e;(e=t.result.split(",")[1])?fetch("http://127.0.0.1:5000/process_image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:e})}).then((e=>e.json())).then((e=>{if(e.error)throw new Error(e.error);!function(e){e.compressed_image?(r.src=e.compressed_image,i.innerHTML=`\n      <p>Compression Ratio: ${e.compression_ratio||"N/A"}</p>\n      <p>PSNR: ${e.psnr||"N/A"}</p>\n      <p>SSIM: ${e.ssim||"N/A"}</p>\n      <p>Memory Usage: ${e.memory_usage||"N/A"} MB</p>\n      <p>Detection Time Without Compression: ${e.detection_time_without_compression||"N/A"} sec</p>\n      <p>Compression Time: ${e.compression_time||"N/A"} sec</p>\n      <p>Detection Time With Compression: ${e.detection_time_with_compression||"N/A"} sec</p>\n  `,a.style.display="none",c.style.display="block",d.style.display="none"):p("No processed image received.")}(e)})).catch((e=>{console.error("Error sending image:",e),p("Error processing image. Ensure the backend is running.")})):p("Error: No Base64 data generated.")}}),"image/jpeg")}))})();